{{- $event_year := (index (split (.File.Dir) "/") 1) -}}
{{- $event_city := (index (split (.File.Dir) "/") 2) -}}
{{- $event_data := .Site.GetPage (printf "/new-events/%s/%s" $event_year $event_city) -}}

<div class = "row">

    <!-- register button -->
    {{- if $event_data.Params.registration_open -}}
      {{- if eq $event_data.Params.registration_open "true" -}}
        {{- if $event_data.Params.registration_link -}}
          {{- if eq $event_data.Params.registration_link "" -}}
            {{- $.Scratch.Set "registration_link" ((printf "/events/%s/registration" $event_data.Params.name) ) -}}
          {{- else -}}
            {{- $.Scratch.Set "registration_link" $event_data.Params.registration_link -}}
          {{- end -}}
        {{- else -}}
          {{- $.Scratch.Set "registration_link" ((printf "/events/%s/registration" $event_data.Params.name) ) -}}
      {{- end -}}
      <div class = "col-auto  offset-1 offset-md-0 welcome-page-cta">
        <a href="{{ $.Scratch.Get "registration_link" }}" class="btn jssocials-share-link event-cta-button" role="button" aria-pressed="true">Register</a>
          </div>
      {{- end -}}
    {{- else -}}
      {{- if $event_data.Params.startdate -}}
        {{- if $event_data.Params.registration_date_start -}}
          {{- if and (ge now (time $event_data.Params.registration_date_start)) (le now (time $event_data.Params.registration_date_end)) -}}
            {{- if $event_data.Params.registration_link -}}
              {{- if eq $event_data.Params.registration_link "" -}}
                {{- $.Scratch.Set "registration_link" ((printf "/events/%s/registration" $event_data.Params.name) ) -}}
              {{- else -}}
                {{- $.Scratch.Set "registration_link" $event_data.Params.registration_link -}}
              {{- end -}}
            {{- else -}}
              {{- $.Scratch.Set "registration_link" ((printf "/events/%s/registration" $event_data.Params.name) ) -}}
            {{- end -}}
            {{- if $event_data.Params.registration_closed -}}
              {{- if ne $event_data.Params.registration_closed "true" -}}
                <div class = "col-auto offset-1 offset-md-0 welcome-page-cta">
                  <a href="{{ $.Scratch.Get "registration_link" }}" class="btn jssocials-share-link event-cta-button" role="button" aria-pressed="true">Register</a>
                </div>
              {{- end -}}
            {{- end -}}
            <div class = "col-auto offset-1 offset-md-0 welcome-page-cta">
              <a href="{{ $.Scratch.Get "registration_link" }}" class="btn jssocials-share-link event-cta-button" role="button" aria-pressed="true">Register</a>
            </div>
          {{- end -}}
        {{- end -}}
      {{- end -}}
    {{- end -}}



  <!-- propose button -->
  {{- if $event_data.Params.startdate -}}
    {{- if $event_data.Params.cfp_date_start -}}
      {{- if and (ge now (time $event_data.Params.cfp_date_start)) (le now (time $event_data.Params.cfp_date_end)) -}}
        {{- if $event_data.Params.cfp_link -}}
          {{- if eq $event_data.Params.cfp_link "" -}}
            {{- $.Scratch.Set "cfp_link" ((printf "/events/%s/propose" $event_data.Params.name) ) -}}
          {{- else -}}
            {{- $.Scratch.Set "cfp_link" $event_data.Params.cfp_link -}}
          {{- end -}}
        {{- else -}}
          {{- $.Scratch.Set "cfp_link" ((printf "/events/%s/propose" $event_data.Params.name) ) -}}
        {{- end -}}
      <div class = "col-auto offset-1 offset-md-0 welcome-page-cta">
        <a href="{{ $.Scratch.Get "cfp_link" }}" class="btn jssocials-share-link event-cta-button" role="button" aria-pressed="true">Propose</a>
      </div>
      {{- end -}}
    {{- end -}}
  {{- end -}}



  <!-- follow on twitter button -->
  {{- if $event_data.Params.event_twitter -}}
    {{- if ne $event_data.Params.event.twitter "" -}}
      <div class = "col-auto  offset-1 offset-md-0 welcome-page-cta">
        <a href="https://twitter.com/{{$event_data.Params.event_twitter}}" class="btn jssocials-share-link event-cta-button" role="button" aria-pressed="true">Follow</a>
      </div>
    {{- end -}}
  {{- end -}}


</div>

{{- if $event_data.Params.masthead_background -}}
  {{- if ne $event_data.Params.masthead_background "" -}}
    <style>
    a.jssocials-share-link {
      color: #fff;
      border-color: #fff;
      background-color: gray;
      z-index: 2;
    }
    a:hover.jssocials-share-link {
      color: #bfbfc1;
      border-color: #bfbfc1;
    }
    </style>
  {{ else }}

    <style>
    a.jssocials-share-link {
      color: white;
      border-color: white;
    }
    a:hover.jssocials-share-link {
      color: #bfbfc1;
      border-color: #bfbfc1;
    }
    </style>
  {{- end -}}
{{- else -}}

  <style>
  a.jssocials-share-link {
    color: white;
    border-color: white;
  }
  a:hover.jssocials-share-link {
    color: #bfbfc1;
    border-color: #bfbfc1;
  }
  </style>

{{- end -}}

<div class = "row">
  <div class = "col-md-12 offset-1 offset-md-0  welcome-page-cta">
    <div id="share"></div>
  </div>

</div>
